import { c as create_ssr_component, a as subscribe, b as escape } from "../../../chunks/ssr.js";
import { a as auth } from "../../../chunks/auth.js";
import "@sveltejs/kit/internal";
import "../../../chunks/exports.js";
import "../../../chunks/utils.js";
import "@sveltejs/kit/internal/server";
import "../../../chunks/state.svelte.js";
/* empty css                                                                */
function goto(url, opts = {}) {
  {
    throw new Error("Cannot call goto(...) on the server");
  }
}
const css = {
  code: ".glass.svelte-10x5qx1{background:rgba(255, 255, 255, 0.05);backdrop-filter:blur(10px);border:1px solid rgba(255, 255, 255, 0.1)}.line-clamp-2.svelte-10x5qx1{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}",
  map: '{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script>\\r\\n  import { onMount } from \\"svelte\\";\\r\\n  import { auth } from \\"$lib/stores/auth\\";\\r\\n  import { api } from \\"$lib/api\\";\\r\\n  import { goto } from \\"$app/navigation\\";\\r\\n  import { Music, Globe, Lock } from \\"lucide-svelte\\";\\r\\n  import PlatformCard from \\"$lib/components/PlatformCard.svelte\\";\\r\\n  import PlaylistImport from \\"$lib/components/PlaylistImport.svelte\\";\\r\\n  import PlaylistImportModal from \\"$lib/components/PlaylistImportModal.svelte\\";\\r\\n\\r\\n  let connectionStatus = {\\r\\n    spotify_connected: false,\\r\\n    youtube_connected: false,\\r\\n    username: \\"\\",\\r\\n  };\\r\\n  let savedPlaylists = [];\\r\\n  let loading = true;\\r\\n  let error = \\"\\";\\r\\n  let showImportModal = false;\\r\\n  let importPlatform = null;\\r\\n\\r\\n  // Reactive statement to check auth\\r\\n  $: if (!$auth.token) {\\r\\n    if (typeof window !== \\"undefined\\") goto(\\"/login\\");\\r\\n  }\\r\\n\\r\\n  onMount(async () => {\\r\\n    if (!$auth.token) return;\\r\\n\\r\\n    // Check if redirected from OAuth\\r\\n    const params = new URLSearchParams(window.location.search);\\r\\n    const connectedPlatform = params.get(\\"connected\\");\\r\\n    if (connectedPlatform) {\\r\\n      // Show import modal after OAuth redirect\\r\\n      importPlatform = connectedPlatform;\\r\\n      showImportModal = true;\\r\\n      // Clean up URL\\r\\n      window.history.replaceState({}, \\"\\", \\"/dashboard\\");\\r\\n    }\\r\\n\\r\\n    await Promise.all([loadConnectionStatus(), loadSavedPlaylists()]);\\r\\n    loading = false;\\r\\n  });\\r\\n\\r\\n  async function loadConnectionStatus() {\\r\\n    try {\\r\\n      const response = await api.get(\\"/api/connection/status\\", $auth.token);\\r\\n      connectionStatus = response;\\r\\n    } catch (e) {\\r\\n      console.error(\\"Failed to load connection status:\\", e);\\r\\n      error = \\"Connection status error: \\" + e.message;\\r\\n    }\\r\\n  }\\r\\n\\r\\n  async function loadSavedPlaylists() {\\r\\n    try {\\r\\n      const response = await api.get(\\"/api/my/playlists\\", $auth.token);\\r\\n      savedPlaylists = response.playlists || [];\\r\\n    } catch (e) {\\r\\n      console.error(\\"Failed to load saved playlists:\\", e);\\r\\n      error = \\"Saved playlists error: \\" + e.message;\\r\\n    }\\r\\n  }\\r\\n\\r\\n  function handleConnectionSuccess(platform) {\\r\\n    // Show import modal after successful connection\\r\\n    importPlatform = platform;\\r\\n    showImportModal = true;\\r\\n    // Reload connection status\\r\\n    loadConnectionStatus();\\r\\n  }\\r\\n\\r\\n  function onImportComplete() {\\r\\n    // Reload playlists after import\\r\\n    loadSavedPlaylists();\\r\\n  }\\r\\n\\r\\n  async function togglePublic(playlistId, currentStatus) {\\r\\n    try {\\r\\n      await api.patch(\\r\\n        `/api/playlists/${playlistId}/public`,\\r\\n        { is_public: !currentStatus },\\r\\n        $auth.token,\\r\\n      );\\r\\n\\r\\n      savedPlaylists = savedPlaylists.map((p) =>\\r\\n        p.id === playlistId ? { ...p, is_public: !currentStatus } : p,\\r\\n      );\\r\\n    } catch (e) {\\r\\n      alert(\\"Failed to update playlist: \\" + e.message);\\r\\n    }\\r\\n  }\\r\\n<\/script>\\r\\n\\r\\n<div class=\\"p-8 pt-24 max-w-7xl mx-auto\\">\\r\\n  <!-- Header -->\\r\\n  <div class=\\"mb-12\\">\\r\\n    <h1 class=\\"text-5xl font-bold mb-2\\">Dashboard</h1>\\r\\n    <p class=\\"text-xl text-white/60\\">\\r\\n      Welcome back{connectionStatus.username\\r\\n        ? `, ${connectionStatus.username}`\\r\\n        : \\"\\"}!\\r\\n    </p>\\r\\n  </div>\\r\\n\\r\\n  {#if loading}\\r\\n    <div class=\\"flex items-center justify-center py-20\\">\\r\\n      <div\\r\\n        class=\\"w-12 h-12 border-4 border-white/20 border-t-apple-blue rounded-full animate-spin\\"\\r\\n      ></div>\\r\\n    </div>\\r\\n  {:else}\\r\\n    <!-- Platform Connections Section -->\\r\\n    <section class=\\"mb-12\\">\\r\\n      <h2 class=\\"text-2xl font-bold mb-6\\">Platform Connections</h2>\\r\\n      <div class=\\"grid grid-cols-1 md:grid-cols-2 gap-6\\">\\r\\n        <PlatformCard\\r\\n          platform=\\"spotify\\"\\r\\n          connected={connectionStatus.spotify_connected}\\r\\n          color=\\"#1DB954\\"\\r\\n          onConnectionSuccess={() => handleConnectionSuccess(\\"spotify\\")}\\r\\n        />\\r\\n        <PlatformCard\\r\\n          platform=\\"youtube\\"\\r\\n          connected={connectionStatus.youtube_connected}\\r\\n          color=\\"#FF0000\\"\\r\\n          onConnectionSuccess={() => handleConnectionSuccess(\\"youtube\\")}\\r\\n        />\\r\\n      </div>\\r\\n    </section>\\r\\n\\r\\n    <!-- Available Playlists Section -->\\r\\n    {#if connectionStatus.spotify_connected || connectionStatus.youtube_connected}\\r\\n      <section class=\\"mb-12\\">\\r\\n        <div class=\\"flex items-center justify-between mb-6\\">\\r\\n          <div>\\r\\n            <h2 class=\\"text-2xl font-bold\\">Import Playlists</h2>\\r\\n            <p class=\\"text-sm text-white/60 mt-1\\">\\r\\n              Import playlists from your connected platforms\\r\\n            </p>\\r\\n          </div>\\r\\n        </div>\\r\\n\\r\\n        <PlaylistImport on:import={loadSavedPlaylists} />\\r\\n      </section>\\r\\n    {/if}\\r\\n\\r\\n    <!-- Saved Playlists Section -->\\r\\n    <section>\\r\\n      <h2 class=\\"text-2xl font-bold mb-6\\">My Saved Playlists</h2>\\r\\n\\r\\n      {#if error}\\r\\n        <div class=\\"glass rounded-2xl p-8 text-center text-red-400\\">\\r\\n          {error}\\r\\n        </div>\\r\\n      {:else if savedPlaylists.length === 0}\\r\\n        <div class=\\"glass rounded-3xl p-12 text-center\\">\\r\\n          <Music class=\\"mx-auto mb-4 opacity-30\\" size={48} />\\r\\n          <h3 class=\\"text-xl font-bold mb-2\\">No Saved Playlists Yet</h3>\\r\\n          <p class=\\"text-white/60 mb-6\\">\\r\\n            Import your first playlist to get started!\\r\\n          </p>\\r\\n          <a\\r\\n            href=\\"/public\\"\\r\\n            class=\\"inline-block px-6 py-3 bg-apple-blue rounded-full font-bold hover:bg-blue-600 transition-colors\\"\\r\\n          >\\r\\n            Browse Public Playlists\\r\\n          </a>\\r\\n        </div>\\r\\n      {:else}\\r\\n        <div class=\\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\\">\\r\\n          {#each savedPlaylists as playlist}\\r\\n            <div\\r\\n              class=\\"glass rounded-2xl p-6 hover:bg-white/10 transition-colors\\"\\r\\n            >\\r\\n              <div class=\\"flex items-start justify-between mb-4\\">\\r\\n                <div class=\\"flex-1\\">\\r\\n                  <h3 class=\\"font-bold text-lg mb-1\\">{playlist.title}</h3>\\r\\n                  <p class=\\"text-sm text-white/50 capitalize\\">\\r\\n                    {playlist.platform}\\r\\n                  </p>\\r\\n                </div>\\r\\n                {#if playlist.cover_image}\\r\\n                  <img\\r\\n                    src={playlist.cover_image}\\r\\n                    alt=\\"\\"\\r\\n                    class=\\"w-12 h-12 rounded-lg object-cover\\"\\r\\n                  />\\r\\n                {/if}\\r\\n              </div>\\r\\n\\r\\n              <p class=\\"text-sm text-white/60 mb-4 line-clamp-2\\">\\r\\n                {playlist.description || \\"No description\\"}\\r\\n              </p>\\r\\n\\r\\n              <div class=\\"flex items-center justify-between\\">\\r\\n                <button\\r\\n                  on:click={() => togglePublic(playlist.id, playlist.is_public)}\\r\\n                  class=\\"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium transition-colors {playlist.is_public\\r\\n                    ? \'bg-green-500/20 text-green-400 hover:bg-green-500/30\'\\r\\n                    : \'bg-white/5 text-white/60 hover:bg-white/10\'}\\"\\r\\n                >\\r\\n                  {#if playlist.is_public}\\r\\n                    <Globe size={14} />\\r\\n                    Public\\r\\n                  {:else}\\r\\n                    <Lock size={14} />\\r\\n                    Private\\r\\n                  {/if}\\r\\n                </button>\\r\\n              </div>\\r\\n            </div>\\r\\n          {/each}\\r\\n        </div>\\r\\n      {/if}\\r\\n    </section>\\r\\n  {/if}\\r\\n</div>\\r\\n\\r\\n<!-- Import Modal -->\\r\\n{#if showImportModal}\\r\\n  <PlaylistImportModal\\r\\n    platform={importPlatform}\\r\\n    onClose={() => (showImportModal = false)}\\r\\n    {onImportComplete}\\r\\n  />\\r\\n{/if}\\r\\n\\r\\n<style>\\r\\n  .glass {\\r\\n    background: rgba(255, 255, 255, 0.05);\\r\\n    backdrop-filter: blur(10px);\\r\\n    border: 1px solid rgba(255, 255, 255, 0.1);\\r\\n  }\\r\\n\\r\\n  .line-clamp-2 {\\r\\n    display: -webkit-box;\\r\\n    -webkit-line-clamp: 2;\\r\\n    -webkit-box-orient: vertical;\\r\\n    overflow: hidden;\\r\\n  }\\r\\n</style>\\r\\n"],"names":[],"mappings":"AAqOE,qBAAO,CACL,UAAU,CAAE,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CACrC,eAAe,CAAE,KAAK,IAAI,CAAC,CAC3B,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAC3C,CAEA,4BAAc,CACZ,OAAO,CAAE,WAAW,CACpB,kBAAkB,CAAE,CAAC,CACrB,kBAAkB,CAAE,QAAQ,CAC5B,QAAQ,CAAE,MACZ"}'
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let $auth, $$unsubscribe_auth;
  $$unsubscribe_auth = subscribe(auth, (value) => $auth = value);
  $$result.css.add(css);
  {
    if (!$auth.token) {
      if (typeof window !== "undefined") goto();
    }
  }
  $$unsubscribe_auth();
  return `<div class="p-8 pt-24 max-w-7xl mx-auto"> <div class="mb-12"><h1 class="text-5xl font-bold mb-2" data-svelte-h="svelte-rubnoj">Dashboard</h1> <p class="text-xl text-white/60">Welcome back${escape("")}!</p></div> ${`<div class="flex items-center justify-center py-20" data-svelte-h="svelte-2ex8r3"><div class="w-12 h-12 border-4 border-white/20 border-t-apple-blue rounded-full animate-spin"></div></div>`}</div>  ${``}`;
});
export {
  Page as default
};
