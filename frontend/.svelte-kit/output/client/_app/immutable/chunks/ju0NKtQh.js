import{s as me,z as te,A as ue,B as Me,C as Te,D as Be,E as je,d,w as He,a as W,i as G,b as u,r as ee,L as $e,M as Ae,l as _,c as p,e as g,f as U,g as H,m as ve,h,t as q,j as O,k as Oe,o as Ge,n as J,p as Xe,N as Ye,u as we}from"./DF-Dz73P.js";import{S as ge,i as be,d as le,t as w,a as $,m as se,b as oe,e as ne,g as de,c as _e}from"./BdLCvuL5.js";import{I as Fe,g as Le,a as Ue,e as De}from"./BeuEQZSN.js";import{a as he,b as Je}from"./DOzjk_c7.js";import{X as Ke}from"./BzGWfxMs.js";import{M as qe}from"./mF8Y1LZz.js";function Qe(s){let e;const o=s[2].default,l=Me(o,s,s[3],null);return{c(){l&&l.c()},l(t){l&&l.l(t)},m(t,n){l&&l.m(t,n),e=!0},p(t,n){l&&l.p&&(!e||n&8)&&Te(l,o,t,t[3],e?je(o,t[3],n,null):Be(t[3]),null)},i(t){e||($(l,t),e=!0)},o(t){w(l,t),e=!1},d(t){l&&l.d(t)}}}function Re(s){let e,o;const l=[{name:"check"},s[1],{iconNode:s[0]}];let t={$$slots:{default:[Qe]},$$scope:{ctx:s}};for(let n=0;n<l.length;n+=1)t=te(t,l[n]);return e=new Fe({props:t}),{c(){ne(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,a){se(e,n,a),o=!0},p(n,[a]){const i=a&3?Le(l,[l[0],a&2&&Ue(n[1]),a&1&&{iconNode:n[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:n}),e.$set(i)},i(n){o||($(e.$$.fragment,n),o=!0)},o(n){w(e.$$.fragment,n),o=!1},d(n){le(e,n)}}}function We(s,e,o){let{$$slots:l={},$$scope:t}=e;const n=[["path",{d:"M20 6 9 17l-5-5"}]];return s.$$set=a=>{o(1,e=te(te({},e),ue(a))),"$$scope"in a&&o(3,t=a.$$scope)},e=ue(e),[n,e,l,t]}class Ze extends ge{constructor(e){super(),be(this,e,We,Re,me,{})}}function xe(s){let e;const o=s[2].default,l=Me(o,s,s[3],null);return{c(){l&&l.c()},l(t){l&&l.l(t)},m(t,n){l&&l.m(t,n),e=!0},p(t,n){l&&l.p&&(!e||n&8)&&Te(l,o,t,t[3],e?je(o,t[3],n,null):Be(t[3]),null)},i(t){e||($(l,t),e=!0)},o(t){w(l,t),e=!1},d(t){l&&l.d(t)}}}function et(s){let e,o;const l=[{name:"plus"},s[1],{iconNode:s[0]}];let t={$$slots:{default:[xe]},$$scope:{ctx:s}};for(let n=0;n<l.length;n+=1)t=te(t,l[n]);return e=new Fe({props:t}),{c(){ne(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,a){se(e,n,a),o=!0},p(n,[a]){const i=a&3?Le(l,[l[0],a&2&&Ue(n[1]),a&1&&{iconNode:n[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:n}),e.$set(i)},i(n){o||($(e.$$.fragment,n),o=!0)},o(n){w(e.$$.fragment,n),o=!1},d(n){le(e,n)}}}function tt(s,e,o){let{$$slots:l={},$$scope:t}=e;const n=[["path",{d:"M5 12h14"}],["path",{d:"M12 5v14"}]];return s.$$set=a=>{o(1,e=te(te({},e),ue(a))),"$$scope"in a&&o(3,t=a.$$scope)},e=ue(e),[n,e,l,t]}class vt extends ge{constructor(e){super(),be(this,e,tt,et,me,{})}}function Ve(s,e,o){const l=s.slice();l[18]=e[o];const t=l[6].has(l[18].id);return l[19]=t,l}function lt(s){let e,o,l=De(s[2]),t=[];for(let a=0;a<l.length;a+=1)t[a]=Se(Ve(s,l,a));const n=a=>w(t[a],1,1,()=>{t[a]=null});return{c(){e=h("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=p(a,"DIV",{class:!0});var i=g(e);for(let r=0;r<t.length;r+=1)t[r].l(i);i.forEach(d),this.h()},h(){_(e,"class","playlists-grid svelte-no652z")},m(a,i){G(a,e,i);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null);o=!0},p(a,i){if(i&212){l=De(a[2]);let r;for(r=0;r<l.length;r+=1){const f=Ve(a,l,r);t[r]?(t[r].p(f,i),$(t[r],1)):(t[r]=Se(f),t[r].c(),$(t[r],1),t[r].m(e,null))}for(de(),r=l.length;r<t.length;r+=1)n(r);_e()}},i(a){if(!o){for(let i=0;i<l.length;i+=1)$(t[i]);o=!0}},o(a){t=t.filter(Boolean);for(let i=0;i<t.length;i+=1)w(t[i]);o=!1},d(a){a&&d(e),Xe(t,a)}}}function st(s){let e,o,l,t,n,a,i;return o=new qe({props:{size:48}}),{c(){e=h("div"),ne(o.$$.fragment),l=O(),t=h("p"),n=q("No playlists found on "),a=q(s[0]),this.h()},l(r){e=p(r,"DIV",{class:!0});var f=g(e);oe(o.$$.fragment,f),l=H(f),t=p(f,"P",{});var b=g(t);n=U(b,"No playlists found on "),a=U(b,s[0]),b.forEach(d),f.forEach(d),this.h()},h(){_(e,"class","empty-state svelte-no652z")},m(r,f){G(r,e,f),se(o,e,null),u(e,l),u(e,t),u(t,n),u(t,a),i=!0},p(r,f){(!i||f&1)&&W(a,r[0])},i(r){i||($(o.$$.fragment,r),i=!0)},o(r){w(o.$$.fragment,r),i=!1},d(r){r&&d(e),le(o)}}}function ot(s){let e,o="Loading your playlists...";return{c(){e=h("div"),e.textContent=o,this.h()},l(l){e=p(l,"DIV",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-8bim1w"&&(e.textContent=o),this.h()},h(){_(e,"class","loader svelte-no652z")},m(l,t){G(l,e,t)},p:J,i:J,o:J,d(l){l&&d(e)}}}function nt(s){let e,o,l,t;function n(){return s[11](s[18])}return{c(){e=h("input"),this.h()},l(a){e=p(a,"INPUT",{type:!0,class:!0}),this.h()},h(){_(e,"type","checkbox"),e.checked=o=s[4].has(s[18].id),_(e,"class","svelte-no652z")},m(a,i){G(a,e,i),l||(t=ee(e,"click",Ae(n)),l=!0)},p(a,i){s=a,i&20&&o!==(o=s[4].has(s[18].id))&&(e.checked=o)},i:J,o:J,d(a){a&&d(e),l=!1,t()}}}function at(s){let e,o,l;return o=new Ze({props:{size:12}}),{c(){e=h("div"),ne(o.$$.fragment),this.h()},l(t){e=p(t,"DIV",{class:!0});var n=g(e);oe(o.$$.fragment,n),n.forEach(d),this.h()},h(){_(e,"class","w-5 h-5 flex items-center justify-center bg-white/20 rounded-full")},m(t,n){G(t,e,n),se(o,e,null),l=!0},p:J,i(t){l||($(o.$$.fragment,t),l=!0)},o(t){w(o.$$.fragment,t),l=!1},d(t){t&&d(e),le(o)}}}function it(s){let e,o,l;return o=new qe({props:{size:24}}),{c(){e=h("div"),ne(o.$$.fragment),this.h()},l(t){e=p(t,"DIV",{class:!0});var n=g(e);oe(o.$$.fragment,n),n.forEach(d),this.h()},h(){_(e,"class","playlist-cover-placeholder svelte-no652z")},m(t,n){G(t,e,n),se(o,e,null),l=!0},p:J,i(t){l||($(o.$$.fragment,t),l=!0)},o(t){w(o.$$.fragment,t),l=!1},d(t){t&&d(e),le(o)}}}function rt(s){let e,o,l;return{c(){e=h("img"),this.h()},l(t){e=p(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){we(e.src,o=s[18].cover_image)||_(e,"src",o),_(e,"alt",l=s[18].title),_(e,"class","playlist-cover svelte-no652z")},m(t,n){G(t,e,n)},p(t,n){n&4&&!we(e.src,o=t[18].cover_image)&&_(e,"src",o),n&4&&l!==(l=t[18].title)&&_(e,"alt",l)},i:J,o:J,d(t){t&&d(e)}}}function Pe(s){let e,o="Imported";return{c(){e=h("span"),e.textContent=o,this.h()},l(l){e=p(l,"SPAN",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-nwfgm9"&&(e.textContent=o),this.h()},h(){_(e,"class","text-[10px] font-bold uppercase tracking-wider bg-white/20 px-1.5 py-0.5 rounded text-white/80")},m(l,t){G(l,e,t)},d(l){l&&d(e)}}}function Ne(s){let e,o=s[18].description+"",l;return{c(){e=h("p"),l=q(o),this.h()},l(t){e=p(t,"P",{class:!0});var n=g(e);l=U(n,o),n.forEach(d),this.h()},h(){_(e,"class","playlist-description svelte-no652z")},m(t,n){G(t,e,n),u(e,l)},p(t,n){n&4&&o!==(o=t[18].description+"")&&W(l,o)},d(t){t&&d(e)}}}function Se(s){let e,o,l,t,n,a,i,r,f,b,N,D=s[18].title+"",V,A,S,E,y,j,c,k;const X=[at,nt],M=[];function Z(z,m){return z[19]?0:1}l=Z(s),t=M[l]=X[l](s);const K=[rt,it],T=[];function x(z,m){return z[18].cover_image?0:1}a=x(s),i=T[a]=K[a](s);let I=s[19]&&Pe(),v=s[18].description&&Ne(s);function F(){return s[12](s[19],s[18])}return{c(){e=h("div"),o=h("div"),t.c(),n=O(),i.c(),r=O(),f=h("div"),b=h("div"),N=h("h3"),V=q(D),A=O(),I&&I.c(),S=O(),v&&v.c(),E=O(),this.h()},l(z){e=p(z,"DIV",{class:!0});var m=g(e);o=p(m,"DIV",{class:!0});var L=g(o);t.l(L),L.forEach(d),n=H(m),i.l(m),r=H(m),f=p(m,"DIV",{class:!0});var C=g(f);b=p(C,"DIV",{class:!0});var Q=g(b);N=p(Q,"H3",{class:!0});var ae=g(N);V=U(ae,D),ae.forEach(d),A=H(Q),I&&I.l(Q),Q.forEach(d),S=H(C),v&&v.l(C),C.forEach(d),E=H(m),m.forEach(d),this.h()},h(){_(o,"class","playlist-checkbox svelte-no652z"),_(N,"class","playlist-title svelte-no652z"),_(b,"class","flex items-center gap-2"),_(f,"class","playlist-info svelte-no652z"),_(e,"class",y="playlist-item "+(s[4].has(s[18].id)?"selected":"")+" "+(s[19]?"opacity-50 cursor-not-allowed":"")+" svelte-no652z")},m(z,m){G(z,e,m),u(e,o),M[l].m(o,null),u(e,n),T[a].m(e,null),u(e,r),u(e,f),u(f,b),u(b,N),u(N,V),u(b,A),I&&I.m(b,null),u(f,S),v&&v.m(f,null),u(e,E),j=!0,c||(k=ee(e,"click",F),c=!0)},p(z,m){s=z;let L=l;l=Z(s),l===L?M[l].p(s,m):(de(),w(M[L],1,1,()=>{M[L]=null}),_e(),t=M[l],t?t.p(s,m):(t=M[l]=X[l](s),t.c()),$(t,1),t.m(o,null));let C=a;a=x(s),a===C?T[a].p(s,m):(de(),w(T[C],1,1,()=>{T[C]=null}),_e(),i=T[a],i?i.p(s,m):(i=T[a]=K[a](s),i.c()),$(i,1),i.m(e,r)),(!j||m&4)&&D!==(D=s[18].title+"")&&W(V,D),s[19]?I||(I=Pe(),I.c(),I.m(b,null)):I&&(I.d(1),I=null),s[18].description?v?v.p(s,m):(v=Ne(s),v.c(),v.m(f,null)):v&&(v.d(1),v=null),(!j||m&84&&y!==(y="playlist-item "+(s[4].has(s[18].id)?"selected":"")+" "+(s[19]?"opacity-50 cursor-not-allowed":"")+" svelte-no652z"))&&_(e,"class",y)},i(z){j||($(t),$(i),j=!0)},o(z){w(t),w(i),j=!1},d(z){z&&d(e),M[l].d(),T[a].d(),I&&I.d(),v&&v.d(),c=!1,k()}}}function ct(s){let e,o,l,t,n,a,i,r,f,b="Select playlists to import into EchoBridge",N,D,V,A,S,E,y,j,c,k,X=s[4].size+"",M,Z,K=s[2].length+"",T,x,I,v,F,z=s[5]?"Importing...":"Import Selected",m,L,C,Q,ae;V=new Ke({props:{size:24}});const ke=[ot,st,lt],R=[];function ye(P,B){return P[3]?0:P[2].length===0?1:2}return E=ye(s),y=R[E]=ke[E](s),{c(){e=h("div"),o=h("div"),l=h("div"),t=h("div"),n=h("h2"),a=q("Import from "),i=q(s[0]),r=O(),f=h("p"),f.textContent=b,N=O(),D=h("button"),ne(V.$$.fragment),A=O(),S=h("div"),y.c(),j=O(),c=h("div"),k=h("div"),M=q(X),Z=q(" of "),T=q(K),x=q(" selected"),I=O(),v=h("div"),F=h("button"),m=q(z),this.h()},l(P){e=p(P,"DIV",{class:!0});var B=g(e);o=p(B,"DIV",{class:!0});var Y=g(o);l=p(Y,"DIV",{class:!0});var re=g(l);t=p(re,"DIV",{});var ce=g(t);n=p(ce,"H2",{class:!0});var pe=g(n);a=U(pe,"Import from "),i=U(pe,s[0]),pe.forEach(d),r=H(ce),f=p(ce,"P",{class:!0,"data-svelte-h":!0}),ve(f)!=="svelte-18yezen"&&(f.textContent=b),ce.forEach(d),N=H(re),D=p(re,"BUTTON",{class:!0});var Ie=g(D);oe(V.$$.fragment,Ie),Ie.forEach(d),re.forEach(d),A=H(Y),S=p(Y,"DIV",{class:!0});var ze=g(S);y.l(ze),ze.forEach(d),j=H(Y),c=p(Y,"DIV",{class:!0});var fe=g(c);k=p(fe,"DIV",{class:!0});var ie=g(k);M=U(ie,X),Z=U(ie," of "),T=U(ie,K),x=U(ie," selected"),ie.forEach(d),I=H(fe),v=p(fe,"DIV",{class:!0});var Ee=g(v);F=p(Ee,"BUTTON",{class:!0});var Ce=g(F);m=U(Ce,z),Ce.forEach(d),Ee.forEach(d),fe.forEach(d),Y.forEach(d),B.forEach(d),this.h()},h(){_(n,"class","text-2xl font-bold capitalize"),_(f,"class","text-sm text-white/60 mt-1"),_(D,"class","close-btn svelte-no652z"),_(l,"class","modal-header svelte-no652z"),_(S,"class","modal-body svelte-no652z"),_(k,"class","selection-info svelte-no652z"),_(F,"class","btn-primary svelte-no652z"),F.disabled=L=s[5]||s[3]||s[4].size===0,_(v,"class","button-group svelte-no652z"),_(c,"class","modal-footer svelte-no652z"),_(o,"class","modal-content glass svelte-no652z"),_(e,"class","modal-overlay svelte-no652z")},m(P,B){G(P,e,B),u(e,o),u(o,l),u(l,t),u(t,n),u(n,a),u(n,i),u(t,r),u(t,f),u(l,N),u(l,D),se(V,D,null),u(o,A),u(o,S),R[E].m(S,null),u(o,j),u(o,c),u(c,k),u(k,M),u(k,Z),u(k,T),u(k,x),u(c,I),u(c,v),u(v,F),u(F,m),C=!0,Q||(ae=[ee(D,"click",function(){$e(s[1])&&s[1].apply(this,arguments)}),ee(F,"click",s[8]),ee(o,"click",Ae(s[10])),ee(e,"click",function(){$e(s[1])&&s[1].apply(this,arguments)})],Q=!0)},p(P,[B]){s=P,(!C||B&1)&&W(i,s[0]);let Y=E;E=ye(s),E===Y?R[E].p(s,B):(de(),w(R[Y],1,1,()=>{R[Y]=null}),_e(),y=R[E],y?y.p(s,B):(y=R[E]=ke[E](s),y.c()),$(y,1),y.m(S,null)),(!C||B&16)&&X!==(X=s[4].size+"")&&W(M,X),(!C||B&4)&&K!==(K=s[2].length+"")&&W(T,K),(!C||B&32)&&z!==(z=s[5]?"Importing...":"Import Selected")&&W(m,z),(!C||B&56&&L!==(L=s[5]||s[3]||s[4].size===0))&&(F.disabled=L)},i(P){C||($(V.$$.fragment,P),$(y),C=!0)},o(P){w(V.$$.fragment,P),w(y),C=!1},d(P){P&&d(e),le(V),R[E].d(),Q=!1,He(ae)}}}function ft(s,e,o){let l;Oe(s,Je,c=>o(13,l=c));let{platform:t="spotify"}=e,{onClose:n=()=>{}}=e,{onImportComplete:a=()=>{}}=e,i=[],r=!0,f=new Set,b=!1,N=new Set;Ge(async()=>{await Promise.all([V(),D()])});async function D(){try{const k=(await he.getPlaylists()).playlists||[];o(6,N=new Set(k.map(X=>X.source_id)))}catch(c){console.error("Failed to load library for duplicate check",c)}}async function V(){o(3,r=!0);try{const c=t==="spotify"?"/api/spotify/playlists":"/api/youtube/playlists",k=await he.get(c,l.token);o(2,i=k.playlists||[])}catch(c){console.error(`Failed to load ${t} playlists:`,c)}o(3,r=!1)}function A(c){if(f.has(c))f.delete(c);else{if(f.size>=3){alert("You can only import up to 3 playlists at a time.");return}f.add(c)}o(4,f)}async function S(){if(f.size===0){alert("Please select at least one playlist");return}o(5,b=!0);try{const c=Array.from(f).map(k=>({platform:t,source_id:k}));await he.post("/api/playlists/batch-import",{playlists:c},l.token),a(),n()}catch(c){console.error("Import failed:",c),alert("Failed to import playlists. Check console for details.")}o(5,b=!1)}function E(c){Ye.call(this,s,c)}const y=c=>A(c.id),j=(c,k)=>!c&&A(k.id);return s.$$set=c=>{"platform"in c&&o(0,t=c.platform),"onClose"in c&&o(1,n=c.onClose),"onImportComplete"in c&&o(9,a=c.onImportComplete)},[t,n,i,r,f,b,N,A,S,a,E,y,j]}class gt extends ge{constructor(e){super(),be(this,e,ft,ct,me,{platform:0,onClose:1,onImportComplete:9})}}export{Ze as C,vt as P,gt as a};
